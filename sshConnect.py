import getpass
from pexpect import pxssh

try:
    HOST = open("SSHIP.txt", "r")
    user = open("SSHusername.txt", "r")
    password = open("SSHpassword.txt", "r")

    HOST = HOST.read().replace('\n', '')
    user = user.read().replace('\n', '')
    password = password.read().replace(' \n', '')

    ssh = pxssh.pxssh()
    ssh.login (HOST, user, password)
    ssh.sendline('passwd')
    ssh.prompt()
    print ssh.before
    ssh.expect_exact('(current) UNIX password:', timeout=60)
    ssh.sendline(password)
    ssh.prompt()
    print ssh.before
    ssh.expect_exact('Enter new UNIX password:', timeout=60)
    ssh.sendline('themonkeyisrunningfast')
    ssh.prompt()
    print ssh.before
    ssh.expect_exact('Retype new UNIX password:', timeout=60)
    ssh.sendline('themonkeyisrunningfast')
    ssh.prompt()
    print ssh.before
    ssh.logout()
except pxssh.ExceptionPxssh,e:
    print "Pxssh failed on login."
    print str(e)
